namespace VyperSecurityAnalyzer.Models;

public class VulnerabilityReport
{
    public string FunctionName { get; set; } = string.Empty;
    public Vulnerability Vulnerability { get; set; }
    public string Description { get; set; } = string.Empty;

    public Severity Severity => Vulnerability switch
    {
        Vulnerability.NoBalanceCheck or
        Vulnerability.SharedState or
        Vulnerability.UncheckedLowLevelCall or
        Vulnerability.TxOriginAuthentication => Severity.High,
        Vulnerability.Reentrancy => Severity.Critical,
        _ =>  throw new ArgumentOutOfRangeException($"Unknown vulnerability")
    };
}
